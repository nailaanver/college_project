{% extends 'base.html' %}
{% load static %}
{% block content %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
:root {
    --navy-dark: #0b1c39;
    --navy: #142850;
    --gold: #f3c623;
    --white: #ffffff;
    --success: #28a745;
    --danger: #dc3545;
}

body {
    background: linear-gradient(rgba(11, 28, 57, 0.92), rgba(11, 28, 57, 0.92)),
                url("{% static 'images/campus.jpg' %}") center/cover no-repeat fixed;
    font-family: 'Poppins', sans-serif;
    padding: 40px 20px;
    margin: 0;
}

/* Page header */
.page-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    margin-bottom: 30px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    padding-bottom: 20px;
}

.subject-info h2 {
    color: var(--white);
    font-size: 28px;
    margin: 0;
    font-weight: 700;
}

.subject-info p {
    color: var(--gold);
    margin: 5px 0 0 0;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    font-size: 14px;
    font-weight: 600;
}

/* Back button */
.back-btn {
    background: rgba(255, 255, 255, 0.1);
    color: var(--white);
    padding: 10px 22px;
    border-radius: 30px;
    text-decoration: none;
    font-weight: 500;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.2);
    transition: 0.3s;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.back-btn:hover {
    background: var(--white);
    color: var(--navy-dark);
}

/* Table Card */
.card {
    background: var(--white);
    border-radius: 24px;
    padding: 0;
    box-shadow: 0 25px 50px rgba(0,0,0,0.4);
    overflow: hidden;
    margin-bottom: 100px; /* Space for sticky footer */
}

.table {
    width: 100%;
    border-collapse: collapse;
}

.table thead th {
    background: #f8f9fa;
    color: #888;
    text-transform: uppercase;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 1px;
    padding: 20px 15px;
    text-align: center;
}

.table tbody td {
    padding: 18px 15px;
    text-align: center;
    color: var(--navy-dark);
    font-size: 14px;
    border-bottom: 1px solid #f2f2f2;
}

.table tbody tr:hover {
    background-color: #fcfcfc;
}

.reg-no {
    font-family: monospace;
    font-weight: 700;
    color: #666;
    background: #f0f0f0;
    padding: 4px 8px;
    border-radius: 6px;
}

.student-name {
    text-align: left !important;
    font-weight: 600;
}

.total-score {
    background: #f0f7ff;
    color: var(--navy);
    padding: 6px 14px;
    border-radius: 8px;
    font-weight: 800;
    border: 1px solid #d0e3ff;
}

/* Floating Action Footer */
.action-footer {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255, 255, 255, 0.95);
    padding: 15px 40px;
    border-radius: 50px;
    display: flex;
    justify-content: center;
    gap: 20px;
    box-shadow: 0 15px 35px rgba(0,0,0,0.3);
    backdrop-filter: blur(10px);
    border: 1px solid var(--white);
    z-index: 100;
    width: fit-content;
}

.approve-btn, .reject-btn {
    padding: 12px 30px;
    border-radius: 30px;
    border: none;
    font-weight: 700;
    font-size: 15px;
    cursor: pointer;
    transition: 0.3s;
    display: flex;
    align-items: center;
    gap: 10px;
}

.approve-btn {
    background: var(--success);
    color: white;
}

.approve-btn:hover {
    background: #218838;
    transform: translateY(-3px);
    box-shadow: 0 8px 15px rgba(40, 167, 69, 0.3);
}

.reject-btn {
    background: #f8f9fa;
    color: var(--danger);
    border: 2px solid var(--danger);
}

.reject-btn:hover {
    background: var(--danger);
    color: white;
    transform: translateY(-3px);
    box-shadow: 0 8px 15px rgba(220, 53, 69, 0.3);
}

@media (max-width: 768px) {
    .page-header { flex-direction: column; align-items: flex-start; gap: 15px; }
    .action-footer { width: 90%; padding: 10px; bottom: 15px; }
    .table thead { display: none; }
    .table td { display: block; text-align: right; padding: 10px; border: none; }
    .table td::before { content: attr(data-label); float: left; font-weight: bold; color: #999; }
    .table tr { border-bottom: 2px solid #eee; display: block; padding: 10px 0; }
}
</style>

<div class="review-container">
    <div class="page-header">
        <div class="subject-info">
            <h2>{{ subject.name }}</h2>
            <p>{{ course }} • Semester {{ semester }} • Internal Marks Review</p>
        </div>
        <a href="{% url 'admin-dashboard' %}" class="back-btn">
            <i class="fas fa-arrow-left"></i> Dashboard
        </a>
    </div>

    <form method="post">
        {% csrf_token %}

        <div class="card">
            <table class="table">
                <thead>
                    <tr>
                        <th style="text-align: left;">Student Details</th>
                        <th>Reg No</th>
                        <th>Test 1</th>
                        <th>Test 2</th>
                        <th>Assignment</th>
                        <th>Attendance</th>
                        <th>Total (Internal)</th>
                    </tr>
                </thead>

                <tbody>
                {% for mark in internal_marks %}
                    <tr>
                        <td data-label="Name" class="student-name">{{ mark.student.first_name }} {{ mark.student.last_name }}</td>
                        <td data-label="Reg No"><span class="reg-no">{{ mark.student.register_number }}</span></td>
                        <td data-label="Test 1">{{ mark.test1 }}</td>
                        <td data-label="Test 2">{{ mark.test2 }}</td>
                        <td data-label="Assignment">{{ mark.assignment }}</td>
                        <td data-label="Attendance">{{ mark.attendance_mark }}</td>
                        <td data-label="Total"><span class="total-score">{{ mark.total_internal }}</span></td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="action-footer">
            <button type="submit" name="reject" class="reject-btn">
                <i class="fas fa-undo"></i> Send Back to Teacher
            </button>
            <button type="submit" name="approve" class="approve-btn">
                <i class="fas fa-check-double"></i> Final Approve
            </button>
        </div>
    </form>
</div>

{% endblock %}